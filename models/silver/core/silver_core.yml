version: 2

models:
  - name: silver__blocks
    tests:
      - dbt_utils.sequential_values:
          column_name: block_number
          interval: 1
          config:
            severity: error
            error_if: ">100"
          tags: ['test_recency']
    columns:
      - name: block_number
        tests:
          - not_null:
              tags: ['test_quality']
          - unique:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: block_hash
        tests:
          - not_null:
              tags: ['test_quality']
          - unique:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: block_timestamp
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: TIMESTAMP_NTZ
              tags: ['test_integrity']
      - name: tx_count_from_versions
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: block_timestamp_num
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: first_version
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: last_version
        tests:
          - not_null:
              tags: ['test_quality']
      - name: blocks_id
      - name: inserted_timestamp
      - name: modified_timestamp
      - name: _invocation_id

  - name: silver__changes
    columns:
      - name: block_number
      - name: block_timestamp
      - name: tx_hash
      - name: version
      - name: success
      - name: tx_type
      - name: payload_function
      - name: change_index
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: change_data
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARIANT
              tags: ['test_integrity']
      - name: change_type
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: address
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: handle
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: inner_change_type
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: change_address
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: change_module
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: change_resource
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: key
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: value
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: state_key_hash
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: changes_id
      - name: inserted_timestamp
      - name: modified_timestamp
      - name: _invocation_id

  - name: silver__events
    columns:
      - name: block_number
      - name: block_timestamp
      - name: tx_hash
      - name: version
      - name: success
      - name: tx_type
      - name: payload_function
      - name: event_index
      - name: event_type
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: event_address
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: event_module
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: event_resource
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: event_data
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARIANT
              tags: ['test_integrity']
      - name: account_address
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: creation_number
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: sequence_number
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: events_id
      - name: inserted_timestamp
      - name: modified_timestamp
      - name: _invocation_id

  - name: silver__transactions
    columns:
      - name: block_timestamp
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: TIMESTAMP_NTZ
              tags: ['test_integrity']
      - name: tx_hash
        tests:
          - not_null:
              tags: ['test_quality']
          - unique:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: version
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: tx_type
        tests:
          - not_null:
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: success
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: BOOLEAN
              tags: ['test_integrity']
      - name: sender
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: signature
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: payload
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARIANT
              tags: ['test_integrity']
      - name: payload_function
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: changes
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARIANT
              tags: ['test_integrity']
      - name: events
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARIANT
              tags: ['test_integrity']
      - name: gas_unit_price
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: gas_used
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: max_gas_amount
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: expiration_timestamp_secs
        tests:
          - dbt_expectations.expect_column_values_to_be_between:
              min_value: 0
              tags: ['test_quality']
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: vm_status
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: state_change_hash
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: accumulator_root_hash
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: event_root_hash
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: state_checkpoint_hash
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: failed_proposer_indices
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARIANT
              tags: ['test_integrity']
      - name: id
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: previous_block_votes_bitvec
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARIANT
              tags: ['test_integrity']
      - name: proposer
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARCHAR
              tags: ['test_integrity']
      - name: ROUND
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: NUMBER
              tags: ['test_integrity']
      - name: data
        tests:
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: VARIANT
              tags: ['test_integrity']
      - name: transactions_id
      - name: inserted_timestamp
      - name: modified_timestamp
      - name: _invocation_id