version: 2
models:
  - name: silver__events
    tests:
      - dbt_utils.expression_is_true:
          expression: "b.value:type IS NOT NULL"
          where: modified_timestamp > current_date - {{ var('test_days_threshold', 3) }}
      - dbt_utils.expression_is_true:
          expression: "b.value:guid:account_address IS NOT NULL AND b.value:guid:creation_number IS NOT NULL"
          where: modified_timestamp > current_date - {{ var('test_days_threshold', 3) }}
    columns:
      - name: block_number
      - name: block_timestamp
      - name: tx_hash
      - name: version
      - name: success
      - name: tx_type
      - name: payload_function
      - name: event_index
      - name: event_type
      - name: event_address
      - name: event_module
      - name: event_resource
      - name: event_data
      - name: account_address
      - name: creation_number
      - name: sequence_number
      - name: events_id
      - name: inserted_timestamp
      - name: modified_timestamp
      - name: _invocation_id
