version: 2
models:
  - name: silver__blocks
    tests:
      - sequence_gaps:
          column: block_number
    columns:
      - name: block_number
        tests:
          - not_null:
              where: modified_timestamp > current_date - {{ var('test_days_threshold', 3) }}
      - name: block_hash
      - name: block_timestamp_num
      - name: block_timestamp
        tests:
          - not_null:
              where: modified_timestamp > current_date - {{ var('test_days_threshold', 3) }}
      - name: first_version
      - name: last_version
      - name: tx_count_from_transactions_array
      - name: tx_count_from_versions
      - name: blocks_id
      - name: inserted_timestamp
      - name: modified_timestamp
      - name: _invocation_id
